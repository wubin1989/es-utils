{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap eee079c5636e4cfdfeda","webpack:///external \"babel-polyfill\"","webpack:///./src/EsUtil.js","webpack:///external \"elasticsearch\"","webpack:///external \"lodash\"","webpack:///./src/dateHistogram.js","webpack:///external \"moment\"","webpack:///./src/hourHistogram.js","webpack:///./src/scroll.js","webpack:///./src/scroll_agg.js","webpack:///./src/search.js","webpack:///./src/createIndex.js","webpack:///./src/getMapping.js","webpack:///./src/putMapping.js","webpack:///./src/getSetting.js","webpack:///./src/putSetting.js","webpack:///./src/update.js","webpack:///./src/bulkUpdate.js","webpack:///./src/bulkIndex.js","webpack:///./src/scrollAndBulkUpdate.js","webpack:///./src/scrollAndAppendFile.js","webpack:///external \"fs_util\"","webpack:///./src/searchById.js","webpack:///./src/mgetByIds.js","webpack:///./src/count.js"],"names":["elasticsearch","require","_","EsUtil","config","index","type","client","Client","cloneDeep","fields","pageSize","sortByField","dateField","query","start_date","end_date","_dateHistogram","bind","_hourHistogram","size","sum","wantedField","_scroll","field","_scroll_agg","page_index","aggs","_search","body","_createIndex","_getMapping","_putMapping","_getSetting","_putSetting","_updateDoc","docs","_bulkUpdateDocs","_bulkIndex","kv","_scrollAndBulkUpdate","file","_scrollAndAppendFile","id","_searchById","ids","_mgetByIds","_count","module","exports","moment","_query","search","volumn","date_histogram","interval","format","time_zone","min_doc_count","extended_bounds","min","getTime","max","subtract","toDate","obj","i","length","sort","options","scroll","search_type","allValues","that","Promise","resolve","reject","getMoreUntilDone","err","response","hits","forEach","hit","push","Array","isArray","value","console","log","compare","total","scrollId","_scroll_id","resolved","sortBy","data","JSON","stringify","from","indices","exists","local","then","resp","create","Error","getMapping","updateAllTypes","putMapping","getSettings","putSettings","flatten","map","item","doc","update","_id","refresh","bulk","kvCopy","count","start","startCopy","more","constructor","name","k","key","trim","_source","forOwn","v","_value","replace","source_value","merge","Set","concat","bulkUpdate","bulkUpdateResult","errors","now","diff","utc","duration","asMilliseconds","totalDiff","raw_speed","speed","toFixed","doc_remain","time_remain","appendFile","checkExists","ensureFile","reduce","len","f","get","mget"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"babel-polyfill\"), require(\"elasticsearch\"), require(\"lodash\"), require(\"moment\"), require(\"fs_util\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"babel-polyfill\", \"elasticsearch\", \"lodash\", \"moment\", \"fs_util\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"babel-polyfill\"), require(\"elasticsearch\"), require(\"lodash\"), require(\"moment\"), require(\"fs_util\")) : factory(root[\"babel-polyfill\"], root[\"elasticsearch\"], root[\"lodash\"], root[\"moment\"], root[\"fs_util\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_21__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eee079c5636e4cfdfeda","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 1\n// module chunks = 0","\"use strict\"\n\nconst elasticsearch = require(\"elasticsearch\")\nconst _ = require(\"lodash\")\n\nclass EsUtil {\n    constructor(config, index, type) {\n        this.client = new elasticsearch.Client(_.cloneDeep(config))\n        this.index = index\n        this.type = type\n    }\n\n    dateHistogram(fields, pageSize, sortByField, dateField, query, start_date, end_date) {\n        const _dateHistogram = require(\"./dateHistogram\").bind(this, fields, pageSize, sortByField, dateField, query, start_date, end_date)\n        return _dateHistogram()\n    }\n\n    hourHistogram(fields, pageSize, sortByField, dateField, query, start_date, end_date) {\n        const _hourHistogram = require(\"./hourHistogram\").bind(this, fields, pageSize, sortByField, dateField, query, start_date, end_date)\n        return _hourHistogram()\n    }\n\n    scroll(fields, size, sum, sortByField, query, wantedField) {\n        const _scroll = require(\"./scroll\").bind(this, fields, size, sum, sortByField, query, wantedField)\n        return _scroll()\n    }\n\n    scroll_agg(field, size, sum, query) {\n        const _scroll_agg = require(\"./scroll_agg\").bind(this, field, size, sum, query)\n        return _scroll_agg()\n    }\n\n    search(pageSize, sortByField, query, page_index, aggs) {\n        const _search = require(\"./search\").bind(this, pageSize, sortByField, query, page_index, aggs)\n        return _search()\n    }\n\n    createIndex(body) {\n        const _createIndex = require(\"./createIndex\").bind(this, body)\n        return _createIndex()\n    }\n\n    getMapping() {\n        const _getMapping = require(\"./getMapping\").bind(this)\n        return _getMapping()\n    }\n\n    putMapping(body) {\n        const _putMapping = require(\"./putMapping\").bind(this, body)\n        return _putMapping()\n    }\n\n    getSetting() {\n        const _getSetting = require(\"./getSetting\").bind(this)\n        return _getSetting()\n    }\n\n    putSetting(body) {\n        const _putSetting = require(\"./putSetting\").bind(this, body)\n        return _putSetting()\n    }\n\n    update(body) {\n        const _updateDoc = require(\"./update\").bind(this, body)\n        return _updateDoc()\n    }\n\n    bulkUpdate(docs) {\n        const _bulkUpdateDocs = require(\"./bulkUpdate\").bind(this, docs)\n        return _bulkUpdateDocs()\n    }\n\n    bulkIndex(docs) {\n        const _bulkIndex = require(\"./bulkIndex\").bind(this, docs)\n        return _bulkIndex()\n    }\n\n    scrollAndBulkUpdate(kv, size, query, sum) {\n        const _scrollAndBulkUpdate = require(\"./scrollAndBulkUpdate\").bind(this, kv, size, query, sum)\n        return _scrollAndBulkUpdate()\n    }\n\n    scrollAndAppendFile(size, query, field, sum, file) {\n        const _scrollAndAppendFile = require(\"./scrollAndAppendFile\").bind(this, size, query, field, sum, file)\n        return _scrollAndAppendFile()\n    }\n\n    searchById(id) {\n        const _searchById = require(\"./searchById\").bind(this, id)\n        return _searchById()\n    }\n\n    mgetByIds(ids) {\n        const _mgetByIds = require(\"./mgetByIds\").bind(this, ids)\n        return _mgetByIds()\n    }\n\n    count(query) {\n        const _count = require(\"./count\").bind(this, query)\n        return _count()\n    }\n}\n\nmodule.exports = EsUtil\n\n\n// WEBPACK FOOTER //\n// ./src/EsUtil.js","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"elasticsearch\"\n// module id = 3\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 4\n// module chunks = 0","\"use strict\"\n\nconst moment = require(\"moment\")\n\nmodule.exports = function(fields, pageSize, sortByField, dateField, query, start_date, end_date){\n    if(!fields){\n        fields = []\n    }\n    const _query = {\n        \"query\": {\n            \"match_all\": {}\n        }\n    }\n    if (query) {\n        _query.query = query\n    }\n    return this.client.search({\n        index: this.index,\n        type: this.type,\n        body: {\n            query: _query,\n            aggs: {\n                volumn: {\n                    date_histogram: {\n                        field: dateField,\n                        interval: \"day\",\n                        format: \"yyyy-M-d\",\n                        time_zone: \"+08:00\",\n                        min_doc_count: 0,\n                        extended_bounds: {\n                            min: start_date.getTime(),\n                            max: moment(end_date).subtract(1, \"days\").toDate().getTime()\n                        }\n                    },\n                    aggs: ((fields)=>{\n                        let obj = {}\n                        for (let i=0; i<fields.length;i++) {\n                            let field = fields[i]\n                            obj[field + \"_sum\"] = {\n                                sum: {\n                                    field: field\n                                }\n                            }\n                        }\n                        return obj\n                    })(fields)\n                }\n            }\n        },\n        size: pageSize,\n        sort: sortByField + \":desc\",\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/dateHistogram.js","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"moment\"\n// module id = 6\n// module chunks = 0","\"use strict\"\n\nconst moment = require(\"moment\")\n\nmodule.exports = function(fields, pageSize, sortByField, dateField, query, start_date, end_date){\n    if(!fields){\n        fields = []\n    }\n    const _query = {\n        \"query\": {\n            \"match_all\": {}\n        }\n    }\n    if (query) {\n        _query.query = query\n    }\n    return this.client.search({\n        index: this.index,\n        type: this.type,\n        body: {\n            query: _query,\n            aggs: {\n                volumn: {\n                    date_histogram: {\n                        field: dateField,\n                        interval: \"hour\",\n                        format: \"yyyy-M-d H:mm\",\n                        time_zone: \"+08:00\",\n                        min_doc_count: 0,\n                        extended_bounds: {\n                            min: start_date.getTime(),\n                            max: moment(end_date).subtract(1, \"hours\").toDate().getTime()\n                        }\n                    },\n                    aggs: ((fields)=>{\n                        let obj = {}\n                        for (let i=0; i<fields.length;i++) {\n                            let field = fields[i]\n                            obj[field + \"_sum\"] = {\n                                sum: {\n                                    field: field\n                                }\n                            }\n                        }\n                        return obj\n                    })(fields)\n                }\n            }\n        },\n        size: pageSize || 0,\n        sort: (sortByField || \"_score\") + \":desc\",\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/hourHistogram.js","\"use strict\"\n\nmodule.exports = function(fields, size, sum, sortByField, query, wantedField) {\n    if (!sum) {\n        sum = 500\n    }\n\n    const _query = {\n        \"query\": {\n            \"match_all\": {}\n        }\n    }\n    if (query) {\n        _query.query = query\n    }\n\n    const options = {\n        index: this.index,\n        type: this.type,\n        scroll: \"60s\",\n        size: size || 50,\n        body: _query,\n        search_type: \"scan\",\n    }\n\n    if (fields) {\n        options.fields = fields\n    }\n    if (sortByField) {\n        options.sort = sortByField + \":desc\"\n    }\n    if (!wantedField) {\n        wantedField = \"fields\"\n    }\n\n    let allValues = []\n    const that = this\n    return new Promise((resolve, reject) => {\n        that.client.search(options, function getMoreUntilDone(err, response) {\n            if (err) {\n                return reject(err)\n            }\n            response.hits.hits.forEach(function(hit) {\n                if (!fields) {\n                    allValues.push(hit)\n                } else {\n                    if (!Array.isArray(wantedField)) {\n                        let value = hit[wantedField]\n                        if (value) {\n                            allValues.push(value)\n                        } else {\n                            console.log(value)\n                            console.log(hit)\n                        }\n                    } else {\n                        let value = {}\n                        for (let i = 0; i < wantedField.length; i++) {\n                            value[wantedField[i]] = hit[wantedField[i]] || {}\n                        }\n                        allValues.push(value)\n                    }\n                }\n            })\n\n            let compare = sum\n            if (response.hits.total < sum) {\n                compare = response.hits.total\n            }\n            if (allValues.length < compare) {\n                that.client.scroll({\n                    scrollId: response._scroll_id,\n                    scroll: \"60s\",\n                }, getMoreUntilDone)\n            } else {\n                let resolved = allValues\n                if (sortByField) {\n                    resolved = {\n                        sortBy: sortByField,\n                        data: allValues,\n                    }\n                }\n                return resolve(resolved)\n            }\n        })\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scroll.js","\"use strict\"\n\nmodule.exports = function(field, size, sum, query) {\n    if (!sum) {\n        sum = 500\n    }\n\n    const _query = {\n        \"query\": {\n            \"match_all\": {}\n        }\n    }\n    if (query) {\n        _query.query = query\n    }\n\n    const options = {\n        index: this.index,\n        type: this.type,\n        scroll: \"60s\",\n        size: size || 50,\n        body: _query,\n        fields: field,\n        search_type: \"scan\",\n    }\n\n    let allValues = []\n    const that = this\n    return new Promise((resolve, reject) => {\n        that.client.search(options, function getMoreUntilDone(err, response) {\n            if (err) {\n                return reject(err)\n            }\n            response.hits.hits.forEach(function(hit) {\n                if (typeof field === \"string\") {\n                    allValues.push(hit.fields ? hit.fields[field][0] : \"\")\n                } else {\n                    allValues.push(hit.fields ? hit.fields : \"\")\n                }\n            })\n\n            let compare = sum\n            if (response.hits.total < sum) {\n                compare = response.hits.total\n            }\n            console.log(compare)\n            if (allValues.length < compare) {\n                console.log(allValues.length)\n                that.client.scroll({\n                    scrollId: response._scroll_id,\n                    scroll: \"60s\",\n                }, getMoreUntilDone)\n            } else {\n                console.log(\"OK\")\n                let resolved = allValues\n                return resolve(resolved)\n            }\n        })\n    })\n}\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n    //\n\n\n// WEBPACK FOOTER //\n// ./src/scroll_agg.js","\"use strict\"\n\nmodule.exports = function(pageSize, sortByField, query, page_index, aggs){\n\n    const _query = {\n        \"query\": {\n            \"match_all\": {}\n        }\n    }\n    if (query) {\n        _query.query = query\n    }\n\n    if (aggs) {\n        _query.aggs = aggs\n    }\n\n    console.log(JSON.stringify(_query, null, 4))\n    console.log(\"-------------------------------\")\n    \n    let options = {\n        index: this.index,\n        type: this.type,\n        body: _query,\n        size: pageSize || 0,\n        from: page_index ? page_index * pageSize : 0,\n    }\n\n\n    if (sortByField) {\n        options.sort = sortByField + \":desc\"\n    }\n\n    return this.client\n        .search(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/search.js","\"use strict\"\n\nmodule.exports = function(body) {\n    return this.client.indices.exists({\n        index: this.index,\n        local: true\n    })\n\t\t.then((resp) => {\n    if (!resp) {\n        return this.client.indices.create({\n            index: this.index,\n            body: body,\n        })\n    } else {\n        throw new Error(\"the index: \" + this.index + \" has already exists!!!\")\n    }\n})\n}\n\n\n// WEBPACK FOOTER //\n// ./src/createIndex.js","\"use strict\"\n\nmodule.exports = function(){\n    return this.client.indices.getMapping({\n        index: this.index,\n        type: this.type\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/getMapping.js","\"use strict\"\n\nmodule.exports = function(body){\n    \n    const options = {\n        index: this.index,\n        type: this.type,\n        body: body,\n        updateAllTypes: false,\n    }\n\n    return this.client.indices.putMapping(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/putMapping.js","\"use strict\"\n\nmodule.exports = function() {\n    return this.client.indices.getSettings({\n        index: this.index,\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/getSetting.js","\"use strict\"\n\nmodule.exports = function(body) {\n\n    const options = {\n        index: this.index,\n        body: body,\n    }\n\n    return this.client.indices.putSettings(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/putSetting.js","\"use strict\"\n\nmodule.exports = function(body){\n    \n    const options = {\n        index: this.index,\n        type: this.type,\n        body: body,\n        updateAllTypes: false,\n    }\n\n    return this.client.indices.putMapping(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/update.js","\"use strict\"\n\nmodule.exports = function(docs) {\n    const _ = require(\"lodash\")\n    const body = _.flatten(_.map(docs, (item) => {\n        const id = item.id\n        const doc = item.doc\n        return [{\n            update: {\n                _id: id\n            }\n        }, {\n            doc: doc,\n            \"detect_noop\": false,\n        }]\n    }))\n    const options = {\n        index: this.index,\n        type: this.type,\n        body: body,\n        refresh: true,\n    }\n\n    return this.client.bulk(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/bulkUpdate.js","\"use strict\"\n\nmodule.exports = function(docs) {\n    const _ = require(\"lodash\")\n    const body = _.flatten(_.map(docs, (item) => {\n        const id = item.id\n        const doc = item.doc\n        return [{\n            index: id ? {\n                _id: id\n            } : {}\n        }, doc]\n    }))\n    const options = {\n        index: this.index,\n        type: this.type,\n        body: body,\n        refresh: true,\n    }\n\n    return this.client.bulk(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/bulkIndex.js","\"use strict\"\n\n/*\n    eg.:\n        kv = [\"tags\", \"userid\"]\n        kv = {\n            tags:{\n                value: [\"apple\"],\n                replace: false\n            }\n            userid: \"123456\"\n        }\n*/\nmodule.exports = function(kv, size, query, sum) {\n    const _ = require(\"lodash\")\n    const moment = require(\"moment\")\n\n    const kvCopy = _.cloneDeep(kv)\n\n    const _query = {\n        \"query\": {\n            \"match_all\": {}\n        }\n    }\n\n    if (query) {\n        _query.query = query\n    }\n\n    console.log(JSON.stringify(_query, null, 4))\n\n    const options = {\n        index: this.index,\n        type: this.type,\n        scroll: \"60s\",\n        size: size || 1000,\n        body: _query,\n        search_type: \"scan\",\n    }\n\n    let count = 0\n\n    const that = this\n\n    return new Promise((resolve, reject) => {\n        let start = moment()\n        const startCopy = _.cloneDeep(start)\n\n        that.client.search(options, async function getMoreUntilDone(err, response) {\n            if (err) {\n                return reject(err)\n            }\n\n            try {\n                const more = response.hits.hits.length\n                const docs = _.map(response.hits.hits, (hit) => {\n                    const id = hit._id\n                    const doc = {}\n\n\n                    if (kvCopy.constructor.name === \"Array\") {\n                        _.forEach(kvCopy, (k) => {\n                            if (k.constructor.name === \"String\") {\n                                const key = k.trim()\n                                doc[key] = hit._source[key]\n                            } else {\n                                throw new Error(\"your provided field name is not string!\")\n                            }\n                        })\n                    } else if (kvCopy.constructor.name === \"Object\") {\n                        _.forOwn(kvCopy, (v, k) => {\n                            let _value = _.cloneDeep(v)\n                            if (v.constructor.name === \"Object\") {\n                                if (v.replace === false) {\n                                    const source_value = _.cloneDeep(hit._source[k])\n                                    _value = v.value\n                                    if (source_value) {\n                                        if (_value.constructor.name === \"Object\" && source_value.constructor.name === \"Object\") {\n                                            _value = _.merge(_value, hit._source[k])\n                                        } else if (_value.constructor.name === \"Array\" && source_value.constructor.name === \"Array\") {\n                                            _value = [...new Set(hit._source[k].concat(_value))]\n                                        }\n                                    }\n                                }\n                            }\n                            doc[k] = _value\n                        })\n                    } else {\n                        if (kvCopy.constructor.name === \"String\") {\n                            const key = kvCopy.trim()\n                            doc[key] = hit._source[key]\n                        } else {\n                            throw new Error(\"your provided field name is not string!\")\n                        }\n                    }\n\n                    return {\n                        id: id,\n                        doc: doc\n                    }\n                })\n\n                if (docs.length) {\n                    const bulkUpdateResult = await that.bulkUpdate(docs)\n                    if (bulkUpdateResult.errors) {\n                        console.log(\"bulk update operation encounter some errors, please check the response: \" + JSON.stringify(bulkUpdateResult, null, 4))\n                    }\n                }\n\n                const now = moment()\n                const diff = moment.utc(moment.duration(now.diff(start)).asMilliseconds()).format(\"HH:mm:ss.SSS\")\n                const totalDiff = moment.utc(moment.duration(now.diff(startCopy)).asMilliseconds()).format(\"HH:mm:ss.SSS\")\n                const raw_speed = more ? (now - start) / more : \"--\"\n                const speed = (more / ((now - start) / 1000)).toFixed(2)\n\n                count += more\n\n                let compare = response.hits.total\n\n                if (sum && (response.hits.total > sum)) {\n                    compare = sum\n                }\n\n                let doc_remain = compare - count\n                if (doc_remain < 0) {\n                    doc_remain = 0\n                }\n                const time_remain = (raw_speed !== \"--\") ? moment.utc(moment.duration(raw_speed * doc_remain).asMilliseconds()).format(\"HH:mm:ss.SSS\") : \"--\"\n\n                console.log(`Finished: ${count}\\tRatio: ${compare ? (count/compare).toFixed(2)*100 : 100}%\\tTimeCost: ${diff}\\tSpeed: ${speed}doc/s\\tTimeRemaining: ${time_remain}\\tTotalTimeCost: ${totalDiff}`)\n\n                start = _.cloneDeep(now)\n\n                if (count < compare) {\n                    that.client.scroll({\n                        scrollId: response._scroll_id,\n                        scroll: \"60s\",\n                    }, getMoreUntilDone)\n                } else {\n                    return resolve(\"scroll and update finished\")\n                }\n            } catch (err) {\n                console.log(err)\n            }\n        })\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scrollAndBulkUpdate.js","\"use strict\"\n\nmodule.exports = function(size, query, field, sum, file) {\n    const _ = require(\"lodash\")\n    const moment = require(\"moment\")\n    const appendFile = require(\"fs_util\").appendFile\n    const checkExists = require(\"fs_util\").checkExists\n\n    const _query = {\n        \"query\": {\n            \"match_all\": {}\n        }\n    }\n\n    if (query) {\n        _query.query = query\n    }\n\n    const options = {\n        index: this.index,\n        type: this.type,\n        scroll: \"60s\",\n        size: size || 1000,\n        body: _query,\n        search_type: \"scan\",\n    }\n\n    if (field) {\n        if (field.constructor.name === \"String\") {\n            options._source = [field]\n        } else if (field.constructor.name === \"Array\") {\n            options._source = field\n        } else {\n            throw new Error(\"Invalid field parameter provided! Only string or array acceptable!\")\n        }\n    }\n\n    let count = 0\n\n    const that = this\n\n    const ensureFile = checkExists(file)\n\n    return new Promise((resolve, reject) => {\n        let start = moment()\n        const startCopy = _.cloneDeep(start)\n\n        that.client.search(options, function getMoreUntilDone(err, response) {\n            if (err) {\n                return reject(err)\n            }\n\n            const more = response.hits.hits.length\n            const data = _.reduce(response.hits.hits, (sum, hit) => {\n                if (options._source) {\n                    const fields = _.cloneDeep(options._source)\n                    const len = fields.length\n                    _.forEach(fields, (f, i) => {\n                        sum += hit._source[f] || \" \"\n                        if (i < (len - 1)) {\n                            sum += \"\\t\"\n                        } else {\n                            sum += \"\\n\"\n                        }\n                    })\n                } else {\n                    sum += JSON.stringify(hit._source) + \"\\n\"\n                }\n                return sum\n            }, \"\")\n\n            if (data) {\n                try {\n                    if (ensureFile) {\n                        appendFile(file, data)\n                    }\n                } catch (err) {\n                    return reject(err)\n                }\n            }\n\n            const now = moment()\n            const diff = moment.utc(moment.duration(now.diff(start)).asMilliseconds()).format(\"HH:mm:ss.SSS\")\n            const totalDiff = moment.utc(moment.duration(now.diff(startCopy)).asMilliseconds()).format(\"HH:mm:ss.SSS\")\n            const raw_speed = more ? (now - start) / more : \"--\"\n            const speed = (more / ((now - start) / 1000)).toFixed(2)\n\n            count += more\n\n            let compare = response.hits.total\n\n            if (sum && (response.hits.total > sum)) {\n                compare = sum\n            }\n\n            let doc_remain = compare - count\n            if (doc_remain < 0) {\n                doc_remain = 0\n            }\n\n            const time_remain = (raw_speed !== \"--\") ? moment.utc(moment.duration(raw_speed * doc_remain).asMilliseconds()).format(\"HH:mm:ss.SSS\") : \"--\"\n\n            console.log(`Finished: ${count}\\tRatio: ${compare ? (count/compare).toFixed(2)*100 : 100}%\\tTimeCost: ${diff}\\tSpeed: ${speed}doc/s\\tTimeRemaining: ${time_remain}\\tTotalTimeCost: ${totalDiff}`)\n\n            start = _.cloneDeep(now)\n\n            if (count < compare) {\n                that.client.scroll({\n                    scrollId: response._scroll_id,\n                    scroll: \"60s\",\n                }, getMoreUntilDone)\n            } else {\n                return resolve(\"append file finished\")\n            }\n\n        })\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scrollAndAppendFile.js","module.exports = __WEBPACK_EXTERNAL_MODULE_21__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs_util\"\n// module id = 21\n// module chunks = 0","\"use strict\"\n\nmodule.exports = function(id) {\n\n    const options = {\n        index: this.index,\n        type: this.type,\n        id: id,\n        refresh: true\n    }\n\n    console.log(options)\n\n    return this.client.get(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/searchById.js","\"use strict\"\n\nmodule.exports = function(ids) {\n\n    const options = {\n        index: this.index,\n        type: this.type,\n        body: {\n            ids: ids\n        },\n        refresh: true\n    }\n\n    return this.client.mget(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/mgetByIds.js","\"use strict\"\n\nmodule.exports = function(query) {\n\tconst _query = {\n\t\t\"query\": {\n\t\t\t\"match_all\": {}\n\t\t}\n\t}\n\tif (query) {\n\t\t_query.query = query\n\t}\n\tconst options = {\n\t\tindex: this.index,\n\t\ttype: this.type,\n\t\tbody: _query,\n\t}\n\treturn this.client\n\t\t.count(options)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/count.js"],"sourceRoot":""}